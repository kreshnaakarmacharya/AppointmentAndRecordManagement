<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Appointment Description</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script th:inline="javascript">
    let isUpdateSuccess = /*[[${isUpdateSuccess}]]*/ false;

    if(isUpdateSuccess){
      alert("The appointment have been updated.")
    } else{
      alert("The appointment update failed. Try again later.")
    }
  </script>
</head>
<body>
<th:block th:insert="DoctorHeader.html"></th:block>
<div class="container mt-5 mb-5">
  <div class="card shadow rounded">
    <div class="card-body">
      <h3 class="card-title mb-4">Appointment Description</h3>

      <div th:object="${ViewAppointmentDetails}">
        <div class="row g-3">
          <div class="col-md-12">
            <label for="title" class="form-label">Appointment Title</label>
            <input type="text" class="form-control" id="title" th:field="*{title}" placeholder="Enter Appointment Title" readonly>
          </div>

          <div class="col-md-12">
            <label for="description" class="form-label">Problem Description</label>
            <textarea class="form-control" id="description" th:field="*{description}" rows="4" placeholder="Describe your issue" readonly></textarea>
          </div>
          <div class="col-md-6">
            <label for="date" class="form-label">Date</label>
            <input type="text" class="form-control" id="date" th:field="*{date}" readonly>
          </div>

          <div class="col-md-6">
            <label for="time" class="form-label">Time</label>
            <input type="text" class="form-control" id="time" th:field="*{time}" readonly>
          </div>
          <div class="mt-4 text-end">
            <form id="approveOrRejectForm" th:method="POST" th:action="@{approveOrRejectAppointment}">
              <input type="hidden" id="appointId" th:field="*{id}"/>
              <input type="hidden" id="approvedOrReject" name="isApproved"/>

              <button onclick="handleApproveOrReject(true)" class="btn btn-success">Approve</button>
              <button onclick="handleApproveOrReject(false)" id="rejectBtn" class="btn btn-danger">Reject</button>
            </form>
          </div>
        </div>
        </div>
      </div>
    </div>
</div>
<script>
  $(document).ready(function() {
    function handleApproveOrReject(value){
      $("#approvedOrReject").val(value);
      $("#approveOrRejectForm").submit();
    }

    // If you want this function to be available globally:
    window.handleApproveOrReject = handleApproveOrReject;
  });
</script>

</body>
</html>
